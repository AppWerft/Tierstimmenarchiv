const DURATION=2e4;var TSA=new(require("model/tsa.adapter"));module.exports=function(e){var t=TSA.getRecordById(e.itemId);if(console.log("RECORDS"),console.log(t),t){var i=Ti.Media.createAudioPlayer({url:t.audio,allowBackground:!0,volume:1});i.addEventListener("progress",function(e){}),i.addEventListener("change",function(e){if(3==e.state){console.log(i.duration);var t=i.duration||DURATION;a.playerView.darker&&a.playerView.darker.animate({width:0,duration:t})}console.log(e.state)}),i.addEventListener("complete",function(e){a.close()});var a=Ti.UI.createWindow({backgroundColor:"transparent"});a.listView=Ti.UI.createTableView({bottom:200}),a.playerView=Ti.UI.createView({backgroundColor:"black",bottom:0,height:200}),a.playerView.add(Ti.UI.createImageView({width:Ti.UI.FILL,height:Ti.UI.FILL,image:t.spectrogram})),a.playerView.darker=Ti.UI.createView({backgroundColor:"#e000",width:"100%",right:0}),a.playerView.add(a.playerView.darker),a.add(a.playerView),a.add(a.listView),a.addEventListener("close",function(){i.pause(),i.stop(),i.release(),i=null}),i.start(),a.addEventListener("open",function(e){if(Ti.Android){var i=require("com.alcoapps.actionbarextras");i.setTitle("Tierstimmenarchiv"),i.setFont("Helvetica-Bold"),i.setSubtitle("Aufnahme von: "+t.Autor),i.displayUseLogoEnabled=!1,i.setStatusbarColor(COLOR.BROWN),i.backgroundColor=COLOR.DARKGREEN,e.source.getActivity().actionBar.displayHomeAsUp=!0;var r=e.source.getActivity();r.actionBar.onHomeIconItemSelected=function(){a.close()}}}),a.open()}};