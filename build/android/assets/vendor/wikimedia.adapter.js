var Module=function(e,t){var a;const n="imagecache.thumbnail";var i=function(){t.onload&&"function"==typeof t.onload&&t.onload(arguments[0])},r=function(){t.onprogress&&"function"==typeof t.onprogress&&t.onprogress(arguments[0])},s=Ti.Filesystem.applicationCacheDirectory,o=Ti.Filesystem.getFile(s,n);o.exists()||o.createDirectory();var d=Ti.Filesystem.getFile(s,n,e+".jpg");if(d.exists()){var _=d.read();i(_)}else{var u=Ti.Network.createHTTPClient({ondatastream:r,onload:function(){var t=/class="thumbimage" srcset="(.*?)"/gi,n=t.exec(this.responseText);if(n&&!n[1].match(/\.svg/)){var r="https:"+n[1].split(" ")[2];if(n=r.replace("/thumb/","/").match(/(^http.*?\.jpg)/i)){a=n[1],console.log(a);var s=Ti.Database.open(DBNAME);s.execute("UPDATE species SET image=? WHERE latin=?",a,e),s.close()}var o=Ti.Network.createHTTPClient({onload:function(){console.log("file written "+this.responseData.length),d.write(this.responseData);var e=d.read();i(e)}});o.open("GET",r),o.send()}}}),l="https://species.wikimedia.org/wiki/"+e.replace(" ","_");u.open("GET",l),u.send()}return this};module.exports=Module;